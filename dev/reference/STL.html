<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multiple seasonal decomposition by Loess — STL • feasts</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multiple seasonal decomposition by Loess — STL" />
<meta property="og:description" content="Decompose a time series into seasonal, trend and remainder components.
Seasonal components are estimated iteratively using STL. Multiple seasonal periods are
allowed. The trend component is computed for the last iteration of STL.
Non-seasonal time series are decomposed into trend and remainder only.
In this case, supsmu is used to estimate the trend.
Optionally, the time series may be Box-Cox transformed before decomposition.
Unlike stl, mstl is completely automated." />
<meta property="og:image" content="https://feasts.tidyverts.org/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145121339-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145121339-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">feasts</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/feasts.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.mitchelloharawild.com/blog/feasts/">Version 0.1.0</a>
    </li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tidyverts/feasts">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple seasonal decomposition by Loess</h1>
    <small class="dont-index">Source: <a href='https://github.com/tidyverts/feasts/blob/master/R/stl.R'><code>R/stl.R</code></a></small>
    <div class="hidden name"><code>STL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Decompose a time series into seasonal, trend and remainder components.
Seasonal components are estimated iteratively using STL. Multiple seasonal periods are
allowed. The trend component is computed for the last iteration of STL.
Non-seasonal time series are decomposed into trend and remainder only.
In this case, <code><a href='https://rdrr.io/r/stats/supsmu.html'>supsmu</a></code> is used to estimate the trend.
Optionally, the time series may be Box-Cox transformed before decomposition.
Unlike <code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code>, <code>mstl</code> is completely automated.</p>
    </div>

    <pre class="usage"><span class='fu'>STL</span>(<span class='no'>formula</span>, <span class='kw'>iterations</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Decomposition specification (see "Specials" section).</p></td>
    </tr>
    <tr>
      <th>iterations</th>
      <td><p>Number of iterations to use to refine the seasonal component.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to <code><a href='https://rdrr.io/r/stats/stl.html'>stats::stl()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='https://fabletools.tidyverts.org/reference/dable.html'>fabletools::dable()</a></code> containing the decomposed trend, seasonality
and remainder from the STL decomposition.</p>
    <h2 class="hasAnchor" id="specials"><a class="anchor" href="#specials"></a>Specials</h2>

    


<h3>trend</h3>
<p>The <code>trend</code> special is used to specify the trend extraction parameters.</p><pre>
trend(window, degree, jump)
</pre>

<table class='table'>
<tr><td><code>window</code></td><td>The span (in lags) of the loess window, which should be odd. If NULL, the default, nextodd(ceiling((1.5*period) / (1-(1.5/s.window)))), is taken.</td></tr>
<tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Should be zero or one.</td></tr>
<tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr>
</table>



<h3>season</h3>
<p>The <code>season</code> special is used to specify the season extraction parameters.</p><pre>
season(period = NULL, window = NULL, degree, jump)
</pre>

<table class='table'>
<tr><td><code>period</code></td><td>The periodic nature of the seasonality. This can be either a number indicating the number of observations in each seasonal period, or text to indicate the duration of the seasonal window (for example, annual seasonality would be "1 year").</td></tr>
<tr><td><code>window</code></td><td>The span (in lags) of the loess window, which should be odd. If the <code>window</code> is set to <code>"periodic"</code> or <code>Inf</code>, the seasonal pattern will be fixed. The window size should be odd and at least 7, according to Cleveland et al. The default (NULL) will choose an appropriate default, for a dataset with one seasonal pattern this would be 11, the second larger seasonal window would be 15, then 19, 23, ... onwards.</td></tr>
<tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Should be zero or one.</td></tr>
<tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr>
</table>



<h3>lowpass</h3>
<p>The <code>lowpass</code> special is used to specify the low-pass filter parameters.</p><pre>
lowpass(window, degree, jump)
</pre>

<table class='table'>
<tr><td><code>window</code></td><td>The span (in lags) of the loess window of the low-pass filter used for each subseries. Defaults to the smallest odd integer greater than or equal to the seasonal <code>period</code> which is recommended since it prevents competition between the trend and seasonal components. If not an odd integer its given value is increased to the next odd one.</td></tr>
<tr><td><code>degree</code></td><td>The degree of locally-fitted polynomial. Must be zero or one.</td></tr>
<tr><td><code>jump</code></td><td>Integers at least one to increase speed of the respective smoother. Linear interpolation happens between every <code>jump</code>th value.</td></tr>
</table>



    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>R. B. Cleveland, W. S. Cleveland, J.E. McRae, and I. Terpenning (1990) STL: A Seasonal-Trend Decomposition Procedure Based on Loess. Journal of Official Statistics, 6, 3–73.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/stl.html'>stl</a></code>, <code><a href='https://rdrr.io/r/stats/supsmu.html'>supsmu</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://tsibble.tidyverts.org/reference/as-tsibble.html'>as_tsibble</a></span>(<span class='no'>USAccDeaths</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>model</span>(<span class='fu'>STL</span>(<span class='no'>value</span> ~ <span class='fu'>trend</span>(<span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>10</span>))) <span class='kw'>%&gt;%</span>
  <span class='fu'>components</span>()</div><div class='output co'>#&gt; # A dable: 72 x 7 [1M]
#&gt; # Key:     .model [1]
#&gt; # :        value = trend + season_year + remainder
#&gt;    .model                  index value trend season_year remainder season_adjust
#&gt;    &lt;chr&gt;                   &lt;mth&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
#&gt;  1 STL(value ~ trend(w… 1973 Jan  9007 9676.       -792.     123.          9799.
#&gt;  2 STL(value ~ trend(w… 1973 Feb  8106 9691.      -1510.     -75.1         9616.
#&gt;  3 STL(value ~ trend(w… 1973 Mar  8928 9706.       -707.     -70.7         9635.
#&gt;  4 STL(value ~ trend(w… 1973 Apr  9137 9720.       -522.     -61.2         9659.
#&gt;  5 STL(value ~ trend(w… 1973 May 10017 9733.        325.     -41.3         9692.
#&gt;  6 STL(value ~ trend(w… 1973 Jun 10826 9753.        843.     229.          9983.
#&gt;  7 STL(value ~ trend(w… 1973 Jul 11317 9764.       1617.     -64.5         9700.
#&gt;  8 STL(value ~ trend(w… 1973 Aug 10744 9734.        981.      28.4         9763.
#&gt;  9 STL(value ~ trend(w… 1973 Sep  9713 9638.       -105.     181.          9818.
#&gt; 10 STL(value ~ trend(w… 1973 Oct  9938 9473.        232.     233.          9706.
#&gt; # … with 62 more rows</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#specials">Specials</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://mitchelloharawild.com'>Mitchell O'Hara-Wild</a>, <a href='http://robjhyndman.com'>Rob Hyndman</a>, <a href='https://earo.me'>Earo Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


